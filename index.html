<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cloud Builder Documentation &mdash; Cloud Builder 0.2.54 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> Cloud Builder
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#cloud-builder-source-setup">Cloud Builder Source Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/git_package_source_setup.html">Git Package Source Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="quickstart/git_package_source_setup.html#understanding-the-project-structure">Understanding the project structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="quickstart/git_package_source_setup.html#understanding-cb-cloud-builder-yml">Understanding <code class="file docutils literal notranslate"><span class="pre">.cb/cloud_builder.yml</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="quickstart/git_package_source_setup.html#understanding-cb-build-root-kiwi">Understanding <code class="file docutils literal notranslate"><span class="pre">.cb/build_root.kiwi</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/git_image_source_setup.html">Git Image Source Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="quickstart/git_image_source_setup.html#understanding-the-project-structure">Understanding the project structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="quickstart/git_image_source_setup.html#understanding-cb-cloud-builder-yml">Understanding <code class="file docutils literal notranslate"><span class="pre">.cb/cloud_builder.yml</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cluster_setup_from_scratch.html">Setup Cloud Builder From Scratch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/kafka_broker_setup.html">Kafka Message Broker Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/control_plane_setup.html">Create and Install the Control Plane</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cluster_setup_from_scratch/control_plane_setup.html#control-plane-configuration">Control Plane Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/runner_setup.html">Runner Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/request_package_build.html">Request a Package Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/auto_rebuild_on_source_change.html">Auto Rebuild on Package Source Change</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/auto_rebuild_on_build_dependencies.html">Auto Rebuild on Package Build Dependency Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_scratch/collect_and_build_project_repos.html">Collect and Build Project Repos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cluster_setup_from_scratch/collect_and_build_project_repos.html#create-and-setup-the-reposerver-instance">Create and Setup the reposerver instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster_setup_from_scratch/collect_and_build_project_repos.html#setup-apache-to-serve-the-repos">Setup Apache to Serve the Repos</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cluster_setup_from_cb_amis.html">Setup Cloud Builder From AMIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_cb_amis.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster_setup_from_cb_amis.html#create-cluster">Create Cluster</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Overview Cloud Builder Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_fetch.html">cb-fetch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_fetch.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_fetch.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_fetch.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_scheduler.html">cb-scheduler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_scheduler.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_scheduler.html#description">DESCRIPTION</a><ul>
<li class="toctree-l4"><a class="reference internal" href="commands/cb_scheduler.html#building-a-package">Building a package:</a></li>
<li class="toctree-l4"><a class="reference internal" href="commands/cb_scheduler.html#build-an-os-image">Build an OS image:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_scheduler.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_prepare.html">cb-prepare</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_prepare.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_prepare.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_prepare.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_run.html">cb-run</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_run.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_run.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_run.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_image.html">cb-image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_image.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_image.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_image.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_info.html">cb-info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_info.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_info.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_info.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_depsolver.html">cb-depsolver</a></li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_collect.html">cb-collect</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_collect.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_collect.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_collect.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/cb_ctl.html">cb-ctl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_ctl.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_ctl.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/cb_ctl.html#options">OPTIONS</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Cloud Builder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>Cloud Builder Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cloud-builder-documentation">
<h1>Cloud Builder Documentation<a class="headerlink" href="#cloud-builder-documentation" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cloud Builder in version 0.2.54 is a new project in its early days.
Some parts are still in development and some parts are still
missing. For details on the current state or the roadmap to
v1.x.x just reach out.</p>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_setup_from_scratch.html">Setup Cloud Builder From Scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_setup_from_cb_amis.html">Setup Cloud Builder From AMIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Overview Cloud Builder Services</a></li>
</ul>
</div>
<aside class="sidebar">
<p class="sidebar-title">Links</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/OSInside/cloud-builder">GitHub Sources</a></p></li>
<li><p><a class="reference external" href="http://download.opensuse.org/repositories/Virtualization:/Appliances:/CloudBuilder">RPM Packages</a></p></li>
<li><p><a class="reference external" href="https://download.opensuse.org/repositories/Virtualization:/Appliances:/CloudBuilder:/EC2:/fedora/images">Amazon EC2 Images</a></p></li>
</ul>
</aside>
<section id="building-software-packages-and-appliances-as-a-service">
<h2>Building Software Packages and Appliances as a Service<a class="headerlink" href="#building-software-packages-and-appliances-as-a-service" title="Permalink to this headline">¶</a></h2>
<p>The Cloud Builder project provides a collection of services which
allows to stand up a package and appliance building backend to
build software packages as well as system images through a
messaging API. Primarily <strong>rpm</strong> and <strong>deb</strong> package formats
are supported as well as any image type supported by the
<a class="reference external" href="https://osinside.github.io/kiwi">KIWI</a> appliance builder.
Cloud Builder is designed to run in cloud environments and this
documentation describes how to run Cloud Builder in
<code class="xref py py-obj docutils literal notranslate"><span class="pre">AWS</span> <span class="pre">(Amazon</span> <span class="pre">Web</span> <span class="pre">Services)</span></code>. However, in general the environment
to run the Cloud Builder services is not restricted to a specific
cloud framework.</p>
</section>
<section id="why">
<h2>Why<a class="headerlink" href="#why" title="Permalink to this headline">¶</a></h2>
<p>If small services for dedicated tasks that can scale with the
amount of tasks and use cases is preferred over a monolithic server.
If easy integration of packaging services with other services is
a priority. If building in an isolated private network should be
possible by utilizing cloud services. If build power, network
bandwidth and storage capacity should be a scalable factor in
the cloud. If managing package sources and build metadata
should be done completely in git. If one ore more of this aspects
are a matching criteria, this project might be interesting.</p>
</section>
<section id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>The Cloud Builder architecture consists out of three major components:</p>
<dl class="simple">
<dt>The Sources:</dt><dd><p>The package and image sources and all metadata to build them with Cloud Builder
must be stored in a git repository from which the Cloud Builder services fetches
information. The idea behind this is that package sources and metadata
is treated like code and git is great in managing code. The history
in Git allows to track any information about changes in the life
time of a package or image. For details how to setup the source
repo see: <a class="reference internal" href="quickstart.html#sources"><span class="std std-ref">Cloud Builder Source Setup</span></a></p>
</dd>
<dt>The Messaging API:</dt><dd><p>Cloud Builder services uses the Apacke Kafka message broker to communicate
for request and response information. From a Cloud Builder implementation
perspective other brokers could be added via a new interface
class. However, it depends on the broker features if it makes
sense to use this message broker together with Cloud Builder. Apacke Kafka
was choosen because it allows for the <em>Publish/Subscribe</em> mode
and for the <em>Shared Queue</em> mode in a nice way. Especially The
<em>Shared Queue</em> mode in combination with the topic partition setup
is used to distribute build requests across the available runner
instances. For details how to setup the messaging API see:
<a class="reference internal" href="cluster_setup_from_scratch/kafka_broker_setup.html#kafka-broker-setup"><span class="std std-ref">Kafka Message Broker Setup</span></a></p>
</dd>
<dt>The Cloud Builder Services:</dt><dd><p>The Cloud Builder services introduced in <a class="reference internal" href="commands.html#services"><span class="std std-ref">Overview Cloud Builder Services</span></a> implements the actual
functionality to allow building a package, or fetching information
about a package, or building repos from packages, and so on. The
services runs on one or more machines representing a certain
functionality like a <code class="xref py py-obj docutils literal notranslate"><span class="pre">runner</span></code> to build packages and images or a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">collector</span></code> to create repositories from build results. The collection
of all machines represents the Cloud Builder cluster.</p>
</dd>
</dl>
<p>The following diagram shows how the Cloud Builder services play together
and provides a visual overview about the system.</p>
<figure class="align-center" id="id1">
<img alt="Cloud Builder Architecture" src="_images/cb-design.png" />
<figcaption>
<p><span class="caption-text">Cloud Builder Architecture</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The minimal infrastructure to build packages with Cloud Builder requires:</p>
<ul class="simple">
<li><p>A git repo with the package sources.
There is the <a class="reference external" href="https://github.com/OSInside/cloud-builder-packages">cloud-builder-packages</a>
example repo</p></li>
<li><p>A Kafka message broker. The focus will be on
<a class="reference external" href="https://docs.aws.amazon.com/msk/latest/developerguide/before-you-begin.html">Amzon MSK</a></p></li>
<li><p>A runner instance with the cb-info and cb-scheduler services running.</p></li>
</ul>
<p>As the idea of Cloud Builder is to come up with a scalable system that
is configurable to the needs of the user, some of the services
are optional on top of the minimal infrastructure.</p>
</div>
</section>
<section id="contact">
<h2>Contact<a class="headerlink" href="#contact" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p><a class="reference external" href="https://matrix.org">Matrix</a></p>
<p>An open network for secure, decentralized communication.
As this project uses appliance building technology and is also one
of my crazy ideas, you can find help in the
<code class="docutils literal notranslate"><span class="pre">#kiwi:matrix.org</span></code> room via
<a class="reference external" href="https://matrix.to/#kiwi:matrix.org">Matrix</a> on the web
or by using the supported
<a class="reference external" href="https://matrix.org/docs/projects/clients-matrix">clients</a>.</p>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-right" title="Quick Start" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Marcus Schäfer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>